<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acronym Search</title>
    <style>
        /* Notion-like Styling */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
            padding: 20px;
            color: #37352f;
            background-color: transparent; /* Matches Notion background */
            margin: 0;
        }

        /* Search Input Styling */
        .search-container {
            position: sticky;
            top: 0;
            background: white;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(55, 53, 47, 0.09);
        }

        input {
            width: 100%;
            padding: 10px 12px;
            font-size: 16px;
            border: 1px solid rgba(55, 53, 47, 0.16);
            border-radius: 6px;
            box-sizing: border-box;
            outline: none;
            background: #f7f9fb;
            transition: all 0.2s ease;
        }

        input:focus {
            background: white;
            border-color: #2eaadc;
            box-shadow: 0 0 0 2px rgba(46, 170, 220, 0.2);
        }

        /* Results Styling */
        #results {
            margin-top: 15px;
        }

        .card {
            padding: 12px 4px;
            border-bottom: 1px solid rgba(55, 53, 47, 0.09);
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .acronym-title {
            font-weight: 600;
            font-size: 1.05em;
            color: #37352f;
            background-color: rgba(235, 236, 237, 0.6);
            padding: 2px 6px;
            border-radius: 4px;
            align-self: flex-start; /* Keeps the badge small */
        }

        .meaning-text {
            color: #4f4e4b;
            font-size: 0.95em;
            line-height: 1.5;
            padding-left: 2px;
        }

        .loading, .no-results {
            color: rgba(55, 53, 47, 0.5);
            font-size: 0.9em;
            text-align: center;
            padding: 20px;
        }
    </style>
</head>
<body>

    <div class="search-container">
        <input type="text" id="searchBox" placeholder="Search acronyms..." autocomplete="off">
    </div>

    <div id="results">
        <div class="loading">Loading dictionary...</div>
    </div>

    <script>
        // YOUR SPECIFIC GOOGLE SHEET LINK
        const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTTZQu_pDVoituFYYch_vc9mxKX2KBt4gzY7HHgYmz8x8KrAGDkh4s5KgIxtdVpq_ZuyG_sUNxaA-u0/pub?output=csv";

        let dictionaryData = [];
        const resultsDiv = document.getElementById('results');
        const searchBox = document.getElementById('searchBox');

        // Robust CSV Parser (Handles commas inside meanings)
        function parseCSV(text) {
            const rows = [];
            // This regex matches a CSV field: either quoted content OR non-comma content
            const pattern = /(".*?"|[^",\r\n]+)(?=\s*,|\s*$)/g; 
            
            const lines = text.split('\n');
            
            // Skip header (i=1 instead of 0)
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i];
                if (!line.trim()) continue; // Skip empty lines
                
                // Matches the line against the CSV pattern
                // If simple split fails, this regex handles quotes: "Meaning, with comma"
                let matches = line.match(/(".*?"|[^",]+)(?=\s*,|\s*)/g);
                
                if (matches && matches.length >= 2) {
                    // Clean up quotes if they exist (e.g. "Text" -> Text)
                    const cleanAcronym = matches[0].replace(/^"|"$/g, '').trim();
                    const cleanMeaning = matches[1].replace(/^"|"$/g, '').trim();
                    
                    rows.push({ acronym: cleanAcronym, meaning: cleanMeaning });
                }
            }
            return rows;
        }

        // Fetch Data
        fetch(sheetUrl)
            .then(res => res.text())
            .then(text => {
                dictionaryData = parseCSV(text);
                resultsDiv.innerHTML = '<div class="no-results">Type above to search</div>';
                console.log("Loaded " + dictionaryData.length + " entries.");
            })
            .catch(err => {
                resultsDiv.innerHTML = '<div class="no-results">Error loading data. Check console.</div>';
                console.error(err);
            });

        // Search Logic
        searchBox.addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase().trim();
            resultsDiv.innerHTML = '';

            // 1. If empty, show nothing (cleaner interface)
            if (term.length === 0) {
                resultsDiv.innerHTML = '<div class="no-results">Type above to search</div>';
                return;
            }

            // 2. Filter logic
            const filtered = dictionaryData.filter(item => 
                item.acronym.toLowerCase().includes(term) || 
                item.meaning.toLowerCase().includes(term)
            );

            // 3. Display Results
            if (filtered.length === 0) {
                resultsDiv.innerHTML = '<div class="no-results">No matches found</div>';
                return;
            }

            filtered.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="acronym-title">${item.acronym}</div>
                    <div class="meaning-text">${item.meaning}</div>
                `;
                resultsDiv.appendChild(card);
            });
        });
    </script>
</body>
</html>
